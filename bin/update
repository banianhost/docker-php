#!/bin/bash

[ ! -f /var/www/src ] && mkdir -p /var/www/src

cd /var/www/src 

## LOCK
if [ -f .update.lock ] ; then
	echo "Lock file '.update.lock' exists, it seems it is already updating ..."
	exit 1
fi
touch .update.lock

# Composer
if [ -f composer.json ] ; then
    composer install --prefer-source --no-ansi --no-interaction --no-progress --optimize-autoloader
fi

# vendor script
if [ -f /bin/vendor ] ; then
	/bin/bash -c /bin/vendor
fi

## LOCK
rm .update.lock
